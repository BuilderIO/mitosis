// Vitest Snapshot v1

exports[`Context > Parse context 1`] = `
{
  "@type": "@builder.io/mitosis/context",
  "name": "SimpleExample",
  "value": {
    "content": {
      "code": null,
      "type": "property",
    },
    "context": {
      "code": {},
      "type": "property",
    },
    "foo": {
      "code": "bar",
      "type": "property",
    },
    "fooUpperCase": {
      "code": "get fooUpperCase() {
  return this.foo.toUpperCase();
}",
      "type": "getter",
    },
    "someMethod": {
      "code": "someMethod() {
  return this.fooUpperCase.toLowercase();
}",
      "type": "method",
    },
    "state": {
      "code": {},
      "type": "property",
    },
  },
}
`;

exports[`Context > Parse context 2`] = `
"import { createContext } from \\"react\\";

export default createContext({
  foo: \\"bar\\",
  get fooUpperCase() {
    return this.foo.toUpperCase();
  },
  someMethod() {
    return this.fooUpperCase.toLowercase();
  },
  content: null,
  context: {},
  state: {},
});
"
`;

exports[`Context > Use and set context in complex components 1`] = `
{
  "@type": "@builder.io/mitosis/component",
  "children": [
    {
      "@type": "@builder.io/mitosis/node",
      "bindings": {},
      "children": [
        {
          "@type": "@builder.io/mitosis/node",
          "bindings": {},
          "children": [],
          "meta": {},
          "name": "div",
          "properties": {
            "_text": "
      ",
          },
          "scope": {},
        },
        {
          "@type": "@builder.io/mitosis/node",
          "bindings": {},
          "children": [],
          "meta": {},
          "name": "div",
          "properties": {
            "_text": "
      ",
          },
          "scope": {},
        },
        {
          "@type": "@builder.io/mitosis/node",
          "bindings": {},
          "children": [],
          "meta": {},
          "name": "div",
          "properties": {
            "_text": "
      ",
          },
          "scope": {},
        },
        {
          "@type": "@builder.io/mitosis/node",
          "bindings": {
            "state.properties": {
              "code": "state.properties",
              "type": "spread",
            },
            "style": {
              "code": "state.css",
            },
          },
          "children": [
            {
              "@type": "@builder.io/mitosis/node",
              "bindings": {},
              "children": [],
              "meta": {},
              "name": "div",
              "properties": {
                "_text": "
        ",
              },
              "scope": {},
            },
            {
              "@type": "@builder.io/mitosis/node",
              "bindings": {
                "block": {
                  "code": "state.useBlock",
                },
              },
              "children": [],
              "meta": {},
              "name": "BlockStyles",
              "properties": {},
              "scope": {},
            },
            {
              "@type": "@builder.io/mitosis/node",
              "bindings": {},
              "children": [],
              "meta": {},
              "name": "div",
              "properties": {
                "_text": "
        ",
              },
              "scope": {},
            },
            {
              "@type": "@builder.io/mitosis/node",
              "bindings": {
                "when": {
                  "code": "state.componentRef",
                },
              },
              "children": [
                {
                  "@type": "@builder.io/mitosis/node",
                  "bindings": {
                    "children": {
                      "code": "state.useBlock.children",
                    },
                    "state.componentOptions": {
                      "code": "state.componentOptions",
                      "type": "spread",
                    },
                  },
                  "children": [],
                  "meta": {},
                  "name": "state.componentRef",
                  "properties": {},
                  "scope": {},
                },
              ],
              "meta": {},
              "name": "Show",
              "properties": {},
              "scope": {},
            },
            {
              "@type": "@builder.io/mitosis/node",
              "bindings": {},
              "children": [],
              "meta": {},
              "name": "div",
              "properties": {
                "_text": "
        ",
              },
              "scope": {},
            },
            {
              "@type": "@builder.io/mitosis/node",
              "bindings": {
                "when": {
                  "code": "!state.componentRef && state.useBlock.children && state.useBlock.children.length",
                },
              },
              "children": [
                {
                  "@type": "@builder.io/mitosis/node",
                  "bindings": {},
                  "children": [],
                  "meta": {},
                  "name": "div",
                  "properties": {
                    "_text": "
          ",
                  },
                  "scope": {},
                },
                {
                  "@type": "@builder.io/mitosis/node",
                  "bindings": {
                    "each": {
                      "code": "state.useBlock.children",
                    },
                  },
                  "children": [
                    {
                      "@type": "@builder.io/mitosis/node",
                      "bindings": {
                        "block": {
                          "code": "child",
                        },
                        "index": {
                          "code": "index",
                        },
                      },
                      "children": [],
                      "meta": {},
                      "name": "RenderBlock",
                      "properties": {},
                      "scope": {},
                    },
                  ],
                  "meta": {},
                  "name": "For",
                  "properties": {},
                  "scope": {
                    "forName": "child",
                    "indexName": "index",
                  },
                },
                {
                  "@type": "@builder.io/mitosis/node",
                  "bindings": {},
                  "children": [],
                  "meta": {},
                  "name": "div",
                  "properties": {
                    "_text": "
        ",
                  },
                  "scope": {},
                },
              ],
              "meta": {},
              "name": "Show",
              "properties": {},
              "scope": {},
            },
            {
              "@type": "@builder.io/mitosis/node",
              "bindings": {},
              "children": [],
              "meta": {},
              "name": "div",
              "properties": {
                "_text": "
      ",
              },
              "scope": {},
            },
          ],
          "meta": {},
          "name": "state.tagName",
          "properties": {},
          "scope": {},
        },
        {
          "@type": "@builder.io/mitosis/node",
          "bindings": {},
          "children": [],
          "meta": {},
          "name": "div",
          "properties": {
            "_text": "
      ",
          },
          "scope": {},
        },
        {
          "@type": "@builder.io/mitosis/node",
          "bindings": {},
          "children": [],
          "meta": {},
          "name": "div",
          "properties": {
            "_text": "
    ",
          },
          "scope": {},
        },
      ],
      "meta": {},
      "name": "Fragment",
      "properties": {},
      "scope": {},
    },
  ],
  "context": {
    "get": {
      "builderContext": {
        "name": "BuilderContext",
        "path": "../context/builder.context.lite:default",
      },
    },
    "set": {},
  },
  "exports": {},
  "hooks": {},
  "imports": [
    {
      "imports": {
        "getBlockComponentOptions": "getBlockComponentOptions",
      },
      "path": "../functions/get-block-component-options",
    },
    {
      "imports": {
        "getBlockProperties": "getBlockProperties",
      },
      "path": "../functions/get-block-properties",
    },
    {
      "imports": {
        "getBlockStyles": "getBlockStyles",
      },
      "path": "../functions/get-block-styles",
    },
    {
      "imports": {
        "getBlockTag": "getBlockTag",
      },
      "path": "../functions/get-block-tag",
    },
    {
      "imports": {
        "components": "components",
      },
      "path": "../functions/register-component",
    },
    {
      "imports": {
        "BuilderContext": "default",
      },
      "path": "../context/builder.context.lite",
    },
    {
      "imports": {
        "getBlockActions": "getBlockActions",
      },
      "path": "../functions/get-block-actions",
    },
    {
      "imports": {
        "getProcessedBlock": "getProcessedBlock",
      },
      "path": "../functions/get-processed-block",
    },
    {
      "imports": {
        "BlockStyles": "default",
      },
      "path": "./block-styles.lite",
    },
  ],
  "inputs": [],
  "meta": {},
  "name": "RenderBlock",
  "propsTypeRef": "RenderBlockProps",
  "refs": {},
  "state": {
    "actions": {
      "code": "get actions() {
  return getBlockActions({
    block: state.useBlock,
    state: builderContext.state,
    context: builderContext.context
  });
}",
      "type": "getter",
    },
    "component": {
      "code": "get component() {
  const componentName = state.useBlock.component?.name;

  if (!componentName) {
    return null;
  }

  const ref = components[state.useBlock.component?.name!];

  if (componentName && !ref) {
    // TODO: Public doc page with more info about this message
    console.warn(\`
          Could not find a registered component named \\"\${componentName}\\".
          If you registered it, is the file that registered it imported by the file that needs to render it?\`);
  }

  return ref;
}",
      "type": "getter",
    },
    "componentInfo": {
      "code": "get componentInfo() {
  return state.component?.info;
}",
      "type": "getter",
    },
    "componentOptions": {
      "code": "get componentOptions() {
  return getBlockComponentOptions(state.useBlock);
}",
      "type": "getter",
    },
    "componentRef": {
      "code": "get componentRef() {
  return state.component?.component;
}",
      "type": "getter",
    },
    "css": {
      "code": "get css() {
  return getBlockStyles(state.useBlock);
}",
      "type": "getter",
    },
    "properties": {
      "code": "get properties() {
  return getBlockProperties(state.useBlock);
}",
      "type": "getter",
    },
    "tagName": {
      "code": "get tagName() {
  return (getBlockTag(state.useBlock) as any);
}",
      "type": "getter",
    },
    "useBlock": {
      "code": "get useBlock() {
  return getProcessedBlock({
    block: props.block,
    state: builderContext.state,
    context: builderContext.context
  });
}",
      "type": "getter",
    },
  },
  "subComponents": [],
  "types": [
    "export type RenderBlockProps = {
  block: BuilderBlock;
  index: number;
};",
  ],
}
`;

exports[`Context > Use and set context in complex components 2`] = `
"import * as React from \\"react\\";
import { useContext } from \\"react\\";

export type RenderBlockProps = {
  block: BuilderBlock;
  index: number;
};
import { getBlockComponentOptions } from \\"../functions/get-block-component-options\\";
import { getBlockProperties } from \\"../functions/get-block-properties\\";
import { getBlockStyles } from \\"../functions/get-block-styles\\";
import { getBlockTag } from \\"../functions/get-block-tag\\";
import { components } from \\"../functions/register-component\\";
import BuilderContext from \\"../context/builder.context.js\\";
import { getBlockActions } from \\"../functions/get-block-actions\\";
import { getProcessedBlock } from \\"../functions/get-processed-block\\";
import BlockStyles from \\"./block-styles.lite\\";

export default function RenderBlock(props: RenderBlockProps) {
  function component() {
    const componentName = useBlock().component?.name;

    if (!componentName) {
      return null;
    }

    const ref = components[useBlock().component?.name];

    if (componentName && !ref) {
      // TODO: Public doc page with more info about this message
      console.warn(\`
        Could not find a registered component named \\"\${componentName}\\".
        If you registered it, is the file that registered it imported by the file that needs to render it?\`);
    }

    return ref;
  }

  function componentInfo() {
    return component?.()?.info;
  }

  function componentRef() {
    return component?.()?.component;
  }

  function tagName() {
    return getBlockTag(useBlock());
  }

  function properties() {
    return getBlockProperties(useBlock());
  }

  function useBlock() {
    return getProcessedBlock({
      block: props.block,
      state: builderContext.state,
      context: builderContext.context,
    });
  }

  function actions() {
    return getBlockActions({
      block: useBlock(),
      state: builderContext.state,
      context: builderContext.context,
    });
  }

  function css() {
    return getBlockStyles(useBlock());
  }

  function componentOptions() {
    return getBlockComponentOptions(useBlock());
  }

  const builderContext = useContext(BuilderContext);

  const TagNameRef = tagName();
  const ComponentRefRef = componentRef();

  return (
    <>
      <TagNameRef {...properties()} style={css()}>
        <BlockStyles block={useBlock()} />

        {componentRef() ? (
          <ComponentRefRef
            {...componentOptions()}
            children={useBlock().children}
          />
        ) : null}

        {!componentRef() &&
        useBlock().children &&
        useBlock().children.length ? (
          <>
            {useBlock().children?.map((child, index) => (
              <RenderBlock index={index} block={child} />
            ))}
          </>
        ) : null}
      </TagNameRef>
    </>
  );
}
"
`;

exports[`Context > Use and set context in components 1`] = `
{
  "@type": "@builder.io/mitosis/component",
  "children": [
    {
      "@type": "@builder.io/mitosis/node",
      "bindings": {},
      "children": [
        {
          "@type": "@builder.io/mitosis/node",
          "bindings": {},
          "children": [],
          "meta": {},
          "name": "div",
          "properties": {
            "_text": "
      ",
          },
          "scope": {},
        },
        {
          "@type": "@builder.io/mitosis/node",
          "bindings": {},
          "children": [
            {
              "@type": "@builder.io/mitosis/node",
              "bindings": {
                "_text": {
                  "code": "foo.value",
                },
              },
              "children": [],
              "meta": {},
              "name": "div",
              "properties": {},
              "scope": {},
            },
          ],
          "meta": {},
          "name": "Fragment",
          "properties": {},
          "scope": {},
        },
        {
          "@type": "@builder.io/mitosis/node",
          "bindings": {},
          "children": [],
          "meta": {},
          "name": "div",
          "properties": {
            "_text": "
    ",
          },
          "scope": {},
        },
      ],
      "meta": {},
      "name": "Fragment",
      "properties": {},
      "scope": {},
    },
  ],
  "context": {
    "get": {
      "foo": {
        "name": "Context1",
        "path": "@dummy/1:default",
      },
    },
    "set": {
      "@dummy/1:default": {
        "name": "Context1",
        "value": {
          "content": {
            "code": "content() {
  return props.content;
}",
            "type": "method",
          },
          "foo": {
            "code": "bar",
            "type": "property",
          },
        },
      },
      "@dummy/2:default": {
        "name": "Context2",
        "value": {
          "bar": {
            "code": "baz",
            "type": "property",
          },
        },
      },
    },
  },
  "exports": {},
  "hooks": {},
  "imports": [
    {
      "imports": {
        "Context1": "default",
      },
      "path": "@dummy/1",
    },
    {
      "imports": {
        "Context2": "default",
      },
      "path": "@dummy/2",
    },
  ],
  "inputs": [],
  "meta": {},
  "name": "ComponentWithContext",
  "propsTypeRef": "ComponentWithContextProps",
  "refs": {},
  "state": {},
  "subComponents": [],
  "types": [
    "export interface ComponentWithContextProps {
  content: string
}",
  ],
}
`;

exports[`Context > Use and set context in components 2`] = `
"import * as React from \\"react\\";
import { useContext } from \\"react\\";

export interface ComponentWithContextProps {
  content: string;
}

import Context1 from \\"@dummy/1\\";
import Context2 from \\"@dummy/2\\";

export default function ComponentWithContext(props: ComponentWithContextProps) {
  const foo = useContext(Context1);

  return (
    <Context2.Provider
      value={{
        bar: \\"baz\\",
      }}
    >
      <Context1.Provider
        value={{
          foo: \\"bar\\",

          content() {
            return props.content;
          },
        }}
      >
        <>{foo.value}</>
      </Context1.Provider>
    </Context2.Provider>
  );
}
"
`;

exports[`Context > Use and set context in components 3`] = `
"import * as React from \\"react\\";
import { View, StyleSheet, Image, Text } from \\"react-native\\";
import { useContext } from \\"react\\";

export interface ComponentWithContextProps {
  content: string;
}

import Context1 from \\"@dummy/1\\";
import Context2 from \\"@dummy/2\\";

export default function ComponentWithContext(props: ComponentWithContextProps) {
  const foo = useContext(Context1);

  return (
    <Context2.Provider
      value={{
        bar: \\"baz\\",
      }}
    >
      <Context1.Provider
        value={{
          foo: \\"bar\\",

          content() {
            return props.content;
          },
        }}
      >
        <>
          <Text>{foo.value}</Text>
        </>
      </Context1.Provider>
    </Context2.Provider>
  );
}
"
`;
